Выполнялось в докере

• После того, как файлы окажутся на HDFS попробуйте выполнить команду, которая выводит содержимое папки. Особенно обратите внимание на права доступа к вашим файлам.

root@814814b32377:/# hdfs dfs -ls /user/cloudera/
Found 4 items
-rw-r--r--   3 root     cloudera     736519 2022-11-19 09:54 /user/cloudera/vim1.txt
-rw-r--r--   3 cloudera cloudera     770324 2022-11-19 10:14 /user/cloudera/vim2.txt
-rw-r--r--   3 cloudera cloudera     843205 2022-11-19 10:32 /user/cloudera/vim3.txt
-rw-r--r--   3 cloudera cloudera     697960 2022-11-19 10:32 /user/cloudera/vim4.txt


• Далее сожмите все 4 тома в 1 файл.

root@814814b32377:/user/cloudera#  hdfs dfs -getmerge /user/cloudera merge.txt
root@814814b32377:/user/cloudera# hdfs dfs -copyFromLocal merge.txt /user/cloudera/
root@814814b32377:/user/cloudera# hdfs dfs -ls /user/cloudera/
Found 5 items
-rw-r--r--   3 root     cloudera    3048008 2022-11-19 10:58 /user/cloudera/merge.txt
-rw-r--r--   3 root     cloudera     736519 2022-11-19 09:54 /user/cloudera/vim1.txt
-rw-r--r--   3 cloudera cloudera     770324 2022-11-19 10:14 /user/cloudera/vim2.txt
-rw-r--r--   3 cloudera cloudera     843205 2022-11-19 10:32 /user/cloudera/vim3.txt
-rw-r--r--   3 cloudera cloudera     697960 2022-11-19 10:32 /user/cloudera/vim4.txt


• Теперь давайте изменим права доступа к нашему файлу. Чтобы с нашим файлом могли взаимодействовать коллеги, установите режим доступа, который дает полный доступ для владельца файла, а для сторонних пользователей возможность читать и выполнять.

root@814814b32377:/user/cloudera# hdfs dfs -chmod 755 /user/cloudera/merge.txt

• Попробуйте заново использовать команду для вывода содержимого папки и обратите внимание как изменились права доступа к файлу.

root@814814b32377:/user/cloudera# hdfs dfs -ls /user/cloudera/
Found 5 items
-rwxr-xr-x   3 root     cloudera    3048008 2022-11-19 10:58 /user/cloudera/merge.txt

• Теперь попробуем вывести на экран информацию о том, сколько места на диске занимает наш файл. Желательно, чтобы размер файла был удобночитаемым.

root@814814b32377:/user/cloudera# hdfs dfs -du -h /user/cloudera/merge.txt
2.9 M  /user/cloudera/merge.txt

• На экране вы можете заметить 2 числа. Первое число – это фактический размер файла, а второе – это занимаемое файлом место на диске с учетом репликации. По умолчанию в данной версии HDFS эти числа будут одинаковы – это означает, что никакой репликации нет – нас это не очень устраивает, мы хотели бы, чтобы у наших файлов существовали резервные копии, поэтому напишите команду, которая изменит фактор репликации на 2.

root@814814b32377:/user/cloudera# hdfs dfs -setrep -w 2 /user/cloudera/merge.txt
Replication 2 set: /user/cloudera/merge.txt
Waiting for /user/cloudera/merge.txt ........................

!!!! Я не дождался окончания выполнения этой команды :(

• Повторите команду, которая выводит информацию о том, какое место на диске занимает файл и убедитесь, что изменения произошли.

root@814814b32377:/user/cloudera# hdfs dfs -stat %r /user/cloudera/merge.txt
2

root@814814b32377:/user/cloudera# hdfs dfs -du -h /user/cloudera/merge.txt
2.9 M  /user/cloudera/merge.txt

• Напишите команду, которая подсчитывает количество строк в вашем файле

root@814814b32377:/user/cloudera# hdfs dfs -cat /user/cloudera/merge.txt | wc -l
10272